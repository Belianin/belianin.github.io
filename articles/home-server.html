<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="./articles.css">
        <title>Домашний сервер</title>
    </head>
    <body>
        <div class="content">
            <article>
                <h1 class="centered article-title">Домашний сервер майкрософтофила</h1>
                <p>Всегда мечтал о своем сервер с белым ip, стоящим у меня дома. Краткий обзор как же я его сделал на стеке Microsoft Windows 10 + ASP NET Core</p>
                <p>Разобраться можно и без скриншотов, но я </p>
                <h3>Белый IP</h3>
                <p>Для начала нужно получить белый IP. Возможность сделать это полностью зависит от провайдера и региона</p>
                <p>Пока у меня был МТС я просто физически не мог его приобрести. Они продавали его только для Москвичей. Уж не знаю с чем это связано. Возможно, это тайный план обострить конфликт между провинцией и столицей.</p>
                <p>Но, поскольку у меня случился переезд и МТС не мог провести Интернет в новый дом, я начал искать другого провайдера.</p>
                <p>Когда я спосил совета у друзей, мне единодушно порекомедовали Ростелеком, поскольку у него есть технология оптоволокна.</p>
                <p>Оказалось, что так как мой дом старый, сюда можно подвести только обычный ethernet-кабель. Но даже без этого, сравнив скорость интернета и абонентскую плату, я решил выбрать Ростелеком.</p>
                <p>И вот у них как раз и оказалась доступна услуга статического (белого) IP. При чем она ещё и стоила в два раза дешевле чем в Москве. Здесь раскачивают уже в другую сторону.</p>
                <p>У Ростелекома подключение интернета идет через <a href="https://ru.wikipedia.org/wiki/PPPoE">PPPoE</a> и после активации статического IP ничего дальше настраивать не нужно.</p>
                <p>Это не реклама.</p>
                <p>Кстати, я удивлен почему это услуга все ещё доступна. Разве нас не пугали что все IPv4 адреса заняты?</p>
                <h3>NAT</h3>
                <p>Отныне мой роутер торчит наружу в интернет. Но он не умеет сам обрабатывать HTTP-запросы. Нужно настроить <a href="https://ru.wikipedia.org/wiki/NAT">NAT</a> для переадресации запросов на компьютер</p>
                <p>Мой роутер - Zyxel NBG6615. Настроить можно переадресацию конкретных протоколов и конктреных портов, но для теста я включил переадресацию всех запросов без фильтров на локальный IP сервера</p>
                <p>Кроме этого, нужно отключить firewall. Я бы все таки хотел как-то настроить его, а не отключать, но возможности такой не нашел.</p>
                <h3>Брандмаузер</h3>
                <p>Теперь запросы приходят на компьютер, но он их отбрасывает, так как порты не открыты наружу.</p>
                <p>Заходим в Брандмаузер и добавляем новое правило и разрешаем нужный диапазон портов. Для теста 5000-5010</p>
                <details>
                    <summary>Картинки</summary>
                    <div style="width: 1000px;">
                        <img src="resources/incomming-connections.png">
                        <img src="resources/create-rule.png">
                    </div>
                    <p class="centered">Отдает XP-шностью</p>       
                </details>      
                <h3>ASP NET Core</h3>
                <p>Открываем Visual Studio (потому что на Rider кончилась студенческая подписка) и создаем базовый шаблон для ASP NET Core</p>
                <p>Меняем метод <code>CreateHostBuilder</code> в <code>Program.cs</code></p>
                <img src="resources/create-host-builder.png">
                <p><code>UseKestrel</code> для того, чтобы не ставить IIS</p>
                <p><code>UseUrls</code> чтобы указать открытый порт и хостовать приложение на локальном IP а не localhost</p>
                <h3>Готово</h3>
            </article>
            <div>13.04.2021</div>
        </div>
    </body>
</html>